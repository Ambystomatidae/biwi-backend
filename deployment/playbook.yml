---
- hosts: all
  become: yes
  roles:
    - docker
  tasks:
    - name: Increase vm.max_map_count
      sysctl:
        name: vm.max_map_count
        value: '262144'
        sysctl_set: yes
        state: present

- hosts: machine-1
  become: yes
  roles:
    - role: docker-swarm
      vars:
        create: 'true'
        type: 'manager'
        network_name: 'biwi-net'

- hosts:
  - machine-2
  - machine-3
  become: yes
  roles:
    - role: docker-swarm
      vars:
        create: 'false'
        type: 'worker'

- hosts:
  - machine-1
  become: yes
  roles:
    - monitoring
    - services
